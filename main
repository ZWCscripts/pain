-- Mobil için modern, mat, sade, koyu, figürsüz avatar değiştirme menüsü
-- YouTube/modern mobil gui stilinde, tamamen fonksiyonel ve minimal

local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local UIS = game:GetService("UserInputService")
local player = Players.LocalPlayer

-- Avatar listesini çek
local function getUserOutfits()
    local userId = player.UserId
    local url = ("https://avatar.roblox.com/v1/users/%d/outfits?itemsPerPage=25"):format(userId)
    local suc, res = pcall(function()
        return HttpService:JSONDecode(game:HttpGet(url))
    end)
    if suc and res and res.data then
        return res.data
    else
        return {}
    end
end

local function wearOutfit(outfitId)
    local url = ("https://avatar.roblox.com/v1/outfits/%d/wear"):format(outfitId)
    pcall(function()
        game:HttpPost(url, "", Enum.HttpContentType.ApplicationJson)
    end)
end

local function resetCharacter()
    player:LoadCharacter()
end

local function createMenu()
    if game.CoreGui:FindFirstChild("MobileAvatarMenu") then
        game.CoreGui.MobileAvatarMenu:Destroy()
    end
    local gui = Instance.new("ScreenGui")
    gui.Name = "MobileAvatarMenu"
    gui.Parent = game.CoreGui
    gui.IgnoreGuiInset = true
    gui.ResetOnSpawn = false
    gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

    -- Ana frame (mat koyu, hafif yuvarlatılmış)
    local frame = Instance.new("Frame", gui)
    frame.Name = "Main"
    frame.AnchorPoint = Vector2.new(0.5,0.5)
    frame.Position = UDim2.new(0.5,0,0.5,0)
    frame.Size = UDim2.new(0, 340, 0, 440)
    frame.BackgroundColor3 = Color3.fromRGB(26, 28, 34)
    frame.BackgroundTransparency = 0
    frame.BorderSizePixel = 0
    frame.Active = true
    frame.Draggable = true

    local uicorner = Instance.new("UICorner", frame)
    uicorner.CornerRadius = UDim.new(0, 18) -- Modern köşe

    -- Logo (üstte)
    local logo = Instance.new("TextLabel", frame)
    logo.Text = "Avatar Değiştirici"
    logo.Font = Enum.Font.GothamBold
    logo.TextColor3 = Color3.fromRGB(0, 170, 255)
    logo.TextSize = 26
    logo.AnchorPoint = Vector2.new(0.5, 0)
    logo.Size = UDim2.new(0.8,0,0,38)
    logo.Position = UDim2.new(0.5,0,0,18)
    logo.BackgroundTransparency = 1
    logo.ZIndex = 3

    -- Kapat butonu (modern stil)
    local kapat = Instance.new("TextButton", frame)
    kapat.Text = "✕"
    kapat.Size = UDim2.new(0,36,0,36)
    kapat.Position = UDim2.new(1,-44,0,12)
    kapat.BackgroundColor3 = Color3.fromRGB(36, 40, 50)
    kapat.BackgroundTransparency = 0
    kapat.TextColor3 = Color3.fromRGB(255,80,80)
    kapat.Font = Enum.Font.GothamBold
    kapat.TextSize = 22
    kapat.BorderSizePixel = 0
    kapat.ZIndex = 5
    local kapatCorner = Instance.new("UICorner", kapat)
    kapatCorner.CornerRadius = UDim.new(0,12)
    kapat.AutoButtonColor = true
    kapat.MouseButton1Click:Connect(function()
        gui:Destroy()
    end)

    -- Küçült butonu (modern dikdörtgen)
    local kucult = Instance.new("TextButton", frame)
    kucult.Text = "─"
    kucult.Size = UDim2.new(0,36,0,36)
    kucult.Position = UDim2.new(1,-88,0,12)
    kucult.BackgroundColor3 = Color3.fromRGB(36, 40, 50)
    kucult.BackgroundTransparency = 0
    kucult.TextColor3 = Color3.fromRGB(0,170,255)
    kucult.Font = Enum.Font.GothamBold
    kucult.TextSize = 18
    kucult.BorderSizePixel = 0
    kucult.ZIndex = 5
    local kucultCorner = Instance.new("UICorner", kucult)
    kucultCorner.CornerRadius = UDim.new(0,12)
    kucult.AutoButtonColor = true

    -- Scrollable avatar listesi
    local scroll = Instance.new("ScrollingFrame", frame)
    scroll.AnchorPoint = Vector2.new(0.5,0)
    scroll.Position = UDim2.new(0.5,0,0,68)
    scroll.Size = UDim2.new(0.9,0,0.75,0)
    scroll.CanvasSize = UDim2.new(0,0,0,0)
    scroll.BackgroundColor3 = Color3.fromRGB(30,33,43)
    scroll.BackgroundTransparency = 0
    scroll.BorderSizePixel = 0
    scroll.ScrollBarThickness = 6
    scroll.ZIndex = 2
    local scrollCorner = Instance.new("UICorner", scroll)
    scrollCorner.CornerRadius = UDim.new(0,12)

    -- Mobil için optimize (sadece mobilde açılır)
    gui.Enabled = not UIS.KeyboardEnabled

    -- Outfits çek ve listele
    local outfits = getUserOutfits()
    local y = 0
    for _, outfit in ipairs(outfits) do
        local btn = Instance.new("TextButton", scroll)
        btn.Size = UDim2.new(1,0,0,43)
        btn.Position = UDim2.new(0,0,0,y)
        btn.BackgroundColor3 = Color3.fromRGB(38, 44, 54)
        btn.BackgroundTransparency = 0
        btn.Text = outfit.name
        btn.TextColor3 = Color3.fromRGB(0,170,255)
        btn.Font = Enum.Font.Gotham
        btn.TextSize = 20
        btn.BorderSizePixel = 0
        btn.AutoButtonColor = true
        local btnCorner = Instance.new("UICorner", btn)
        btnCorner.CornerRadius = UDim.new(0,9)

        btn.MouseButton1Click:Connect(function()
            wearOutfit(outfit.id)
            wait(0.7)
            resetCharacter()
        end)
        y = y + 47
    end
    scroll.CanvasSize = UDim2.new(0,0,0,y)

    -- Küçültme logic'i
    local minimized = false
    kucult.MouseButton1Click:Connect(function()
        minimized = not minimized
        scroll.Visible = not minimized
        if minimized then
            frame.Size = UDim2.new(0,120,0,60)
            logo.Position = UDim2.new(0.5,0,0,7)
            logo.TextSize = 15
        else
            frame.Size = UDim2.new(0,340,0,440)
            logo.Position = UDim2.new(0.5,0,0,18)
            logo.TextSize = 26
        end
    end)
end

createMenu()
