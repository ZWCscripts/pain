-- KANLI/KIRMIZI AVATAR DEĞİŞTİRİCİ (Mobile, küçük, yavaş yanıp sönen "made by ZWCscripts")

local HttpService = game:GetService("HttpService")
local UIS = game:GetService("UserInputService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- API'den outfitleri çek
local function getUserOutfits()
    local userId = LocalPlayer.UserId
    local url = ("https://avatar.roblox.com/v1/users/%d/outfits?itemsPerPage=100"):format(userId)
    local suc, res = pcall(function()
        return HttpService:JSONDecode(game:HttpGet(url))
    end)
    if suc and res and res.data then
        return res.data
    else
        return {}
    end
end

-- Outfiti giydir ve reset at
local function wearOutfit(outfitId)
    local url = ("https://avatar.roblox.com/v1/outfits/%d/wear"):format(outfitId)
    pcall(function()
        game:HttpPost(url, "", Enum.HttpContentType.ApplicationJson)
    end)
    wait(0.8)
    LocalPlayer:LoadCharacter()
end

-- Menü oluştur
local function createMenu()
    if game.CoreGui:FindFirstChild("MobileAvatarMenu") then
        game.CoreGui.MobileAvatarMenu:Destroy()
    end

    local gui = Instance.new("ScreenGui", game.CoreGui)
    gui.Name = "MobileAvatarMenu"
    gui.ResetOnSpawn = false
    gui.IgnoreGuiInset = true
    gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

    -- Ana panel (mobile küçük)
    local frame = Instance.new("Frame", gui)
    frame.Name = "Main"
    frame.AnchorPoint = Vector2.new(0.5,0.5)
    frame.Position = UDim2.new(0.5,0,0.60,0)
    frame.Size = UDim2.new(0, 220, 0, 310)
    frame.BackgroundColor3 = Color3.fromRGB(30, 5, 10)
    frame.BackgroundTransparency = 0.22
    frame.BorderSizePixel = 0
    frame.Active = true
    frame.Draggable = true

    -- Gölgeli ve hafif kan efekti için UIGradient
    local gradient = Instance.new("UIGradient", frame)
    gradient.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(80,0,0)),
        ColorSequenceKeypoint.new(0.7, Color3.fromRGB(30,5,10)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(120,15,20))
    }
    gradient.Rotation = 90

    -- Başlık
    local title = Instance.new("TextLabel", frame)
    title.Text = "KANLI AVATAR"
    title.Font = Enum.Font.GothamBlack
    title.TextColor3 = Color3.fromRGB(200,0,0)
    title.TextStrokeTransparency = 0
    title.TextStrokeColor3 = Color3.fromRGB(50,0,0)
    title.TextSize = 21
    title.Size = UDim2.new(1, -64, 0, 34)
    title.Position = UDim2.new(0, 18, 0, 8)
    title.BackgroundTransparency = 1
    title.TextXAlignment = Enum.TextXAlignment.Left

    -- Kapat butonu
    local kapat = Instance.new("TextButton", frame)
    kapat.Text = "✕"
    kapat.Size = UDim2.new(0,32,0,32)
    kapat.Position = UDim2.new(1,-38,0,6)
    kapat.BackgroundTransparency = 1
    kapat.TextColor3 = Color3.fromRGB(200,0,40)
    kapat.Font = Enum.Font.GothamBlack
    kapat.TextSize = 21
    kapat.BorderSizePixel = 0
    kapat.ZIndex = 5
    kapat.MouseButton1Click:Connect(function()
        gui:Destroy()
    end)

    -- Küçült butonu
    local kucult = Instance.new("TextButton", frame)
    kucult.Text = "—"
    kucult.Size = UDim2.new(0,32,0,32)
    kucult.Position = UDim2.new(1,-70,0,6)
    kucult.BackgroundTransparency = 1
    kucult.TextColor3 = Color3.fromRGB(120,0,20)
    kucult.Font = Enum.Font.GothamBlack
    kucult.TextSize = 21
    kucult.BorderSizePixel = 0
    kucult.ZIndex = 5

    local min = false
    kucult.MouseButton1Click:Connect(function()
        min = not min
        for _,child in ipairs(frame:GetChildren()) do
            if not (child == kucult or child == kapat or child == title) then
                child.Visible = not min
            end
        end
        if min then
            frame.Size = UDim2.new(0,90,0,46)
        else
            frame.Size = UDim2.new(0,220,0,310)
        end
    end)

    -- Outfits scroll paneli
    local scroll = Instance.new("ScrollingFrame", frame)
    scroll.AnchorPoint = Vector2.new(0.5,0)
    scroll.Position = UDim2.new(0.5,0,0,46)
    scroll.Size = UDim2.new(0.94,0,0.75,0)
    scroll.CanvasSize = UDim2.new(0,0,0,0)
    scroll.BackgroundTransparency = 1
    scroll.BorderSizePixel = 0
    scroll.ScrollBarThickness = 5

    -- BLOODY "made by ZWCscripts" (yavaşça yanıp sönen)
    local mark = Instance.new("TextLabel", frame)
    mark.Text = "made by ZWCscripts"
    mark.Font = Enum.Font.GothamBlack
    mark.TextSize = 15
    mark.TextColor3 = Color3.fromRGB(255,10,30)
    mark.TextStrokeTransparency = 0.25
    mark.TextStrokeColor3 = Color3.fromRGB(150,0,20)
    mark.BackgroundTransparency = 1
    mark.Position = UDim2.new(0,0,1,-23)
    mark.Size = UDim2.new(1,0,0,19)
    mark.TextXAlignment = Enum.TextXAlignment.Center

    -- Yanıp sönme efekti (hafif, yavaş, çok parlak değil)
    spawn(function()
        local up = true
        while mark and mark.Parent do
            for i=0,50 do
                mark.TextTransparency = 0.05 + (math.abs(math.sin(i/50*math.pi)) * 0.42)
                mark.TextStrokeTransparency = 0.2 + (math.abs(math.sin(i/50*math.pi)) * 0.5)
                wait(0.025)
            end
            wait(0.2)
        end
    end)

    -- Mobile için optimize
    gui.Enabled = UIS.TouchEnabled and not UIS.KeyboardEnabled

    -- Outfits çek ve listele
    local outfits = getUserOutfits()
    local y = 0
    for _, outfit in ipairs(outfits) do
        local btn = Instance.new("TextButton", scroll)
        btn.Size = UDim2.new(1,0,0,40)
        btn.Position = UDim2.new(0,0,0,y)
        btn.BackgroundColor3 = Color3.fromRGB(60,0,10)
        btn.BackgroundTransparency = 0.16
        btn.Text = outfit.name
        btn.TextColor3 = Color3.fromRGB(200,16,32)
        btn.Font = Enum.Font.GothamBlack
        btn.TextSize = 17
        btn.BorderSizePixel = 0
        btn.AutoButtonColor = true

        -- Minik avatar resmi
        if outfit.thumbnailUrl then
            local thumb = Instance.new("ImageLabel", btn)
            thumb.Image = outfit.thumbnailUrl
            thumb.Size = UDim2.new(0,28,0,28)
            thumb.Position = UDim2.new(0,5,0,6)
            thumb.BackgroundTransparency = 1
        end

        btn.MouseButton1Click:Connect(function()
            wearOutfit(outfit.id)
        end)
        y = y + 42
    end
    scroll.CanvasSize = UDim2.new(0,0,0,y)
end

createMenu()
